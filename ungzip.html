<!DOCTYPE html>
<html>
<head>
    <title>Decompress GZIP using pako</title>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js"></script>
    <script src="https://unpkg.com/fflate"></script>
    <script src="https://cdn.jsdelivr.net/npm/lzma@2.3.2/src/lzma_worker.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/npm/xz-js@0.0.3/xz.min.js"></script>
</head>
<body>
    <script>
        async function fetchAndDecompressXZ(url) {
            try {
                // Fetch the .xz file as a binary blob
                const response = await fetch(url);
                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }
                const arrayBuffer = await response.arrayBuffer();
                const uint8Array = new Uint8Array(arrayBuffer);

                // Decompress the .xz file
                XZ.decompress(uint8Array, (result, error) => {
                    if (error) {
                        console.error('Decompression error:', error);
                        return;
                    }

                    // Convert the decompressed result to a string
                    const jsonString = new TextDecoder("utf-8").decode(result);

                    // Parse the JSON string
                    try {
                        const jsonData = JSON.parse(jsonString);
                        console.log(jsonData);
                    } catch (parseError) {
                        console.error('JSON parsing error:', parseError);
                    }
                });
            } catch (error) {
                console.error('Error fetching the .xz file:', error);
            }
        }

        // Example usage:
        const url = 'data/features_dp.geojson.xz'; // Replace with your actual file URL
        fetchAndDecompressXZ(url);
    </script>
    <script>
        // async function fetchAndDecompressXZ(url) {
        //     try {
        //         // Fetch the .xz file as a binary blob
        //         const response = await fetch(url);
        //         if (!response.ok) {
        //             throw new Error(`HTTP error! Status: ${response.status}`);
        //         }
        //         const arrayBuffer = await response.arrayBuffer();
        //         const uint8Array = new Uint8Array(arrayBuffer);

        //         // Decompress the .xz file
        //         LZMA.decompress(uint8Array, (result, error) => {
        //             if (error) {
        //                 throw new Error('Decompression error: ' + error);
        //             }

        //             // Convert the decompressed result to a string
        //             const jsonString = new TextDecoder("utf-8").decode(result);

        //             // Parse the JSON string
        //             const jsonData = JSON.parse(jsonString);

        //             // Log the result
        //             console.log(jsonData);
        //         });
        //     } catch (error) {
        //         console.error('Error fetching or decompressing the .xz file:', error);
        //     }
        // }
        // const url = 'data/features_dp.geojson.xz';
        // fetchAndDecompressXZ(url);
    </script>
    <script>
        // // Function to decompress gzipped data using pako
        // function decompressGzip(gzipData) {
        //     try {
        //         // Convert binary data to Uint8Array
        //         const uint8Array = new Uint8Array(gzipData);
        //         // Decompress using pako
        //         const decompressedData = pako.ungzip(uint8Array, { to: 'string' });
        //         return decompressedData;
        //     } catch (error) {
        //         console.error('Error decompressing gzip data:', error);
        //         return null;
        //     }
        // }

        // // Fetch and decompress GZIP file
        // fetch('path/to/your/file.gz')
        //     .then(response => response.arrayBuffer())
        //     .then(gzipData => {
        //         const decompressed = decompressGzip(gzipData);
        //         console.log('Decompressed data:', decompressed);
        //     })
        //     .catch(error => console.error('Fetch error:', error));
    </script>
    <script>
        
        // async function fetchAndDecompressXZ(url) {
        //     try {
        //         // Fetch the .xz file as a binary blob
        //         const response = await fetch(url);
        //         const arrayBuffer = await response.arrayBuffer();

        //         // Decompress the .xz file synchronously
        //         const decompressed = fflate.decompressSync(new Uint8Array(arrayBuffer));

        //         // Convert the decompressed result to a string
        //         const jsonString = new TextDecoder("utf-8").decode(decompressed);

        //         // Parse the JSON string
        //         const jsonData = JSON.parse(jsonString);

        //         // Log the result
        //         console.log(jsonData);
        //     } catch (error) {
        //         console.error('Error fetching or decompressing the .xz file:', error);
        //     }
        // }

        // // Example usage:
        
        // const url = 
        // fetchAndDecompressXZ(url);
        
    </script>
</body>
</html>